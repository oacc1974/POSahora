<analysis>**original_problem_statement:**
El usuario solicitó un sistema de Punto de Venta (POS) que evolucionó para incluir una nueva funcionalidad masiva: un sistema completo y separado de Facturación Electrónica (FE) para el SRI de Ecuador.

Durante esta sesión, el usuario informó de dos problemas principales:
1.  Las notas de crédito no se podían crear correctamente.
2.  Las ventas con facturación electrónica no aparecían en los reportes de recibos.

A lo largo de la sesión, las solicitudes se expandieron para incluir:
- Rediseñar el PDF de la factura (RIDE) para que coincida con un formato específico, incluyendo el logo.
- Solucionar la lentitud del sistema al facturar, implementando un proceso asíncrono.
- Corregir el listado de documentos electrónicos para que se muestren todos y en el orden correcto.
- Crear una nueva sección en el menú para la Facturación Electrónica, separando facturas y notas de crédito.
- Depurar múltiples errores que impedían la creación y autorización de notas de crédito, culminando en un error de FIRMA INVALIDA.

**User's preferred language**: Spanish. The next agent MUST respond in Spanish.

**what currently exists?**
- Una arquitectura de tres servicios:  (POS, puerto 8001),  (Facturación Electrónica, puerto 8002) y  (Firmador Java XAdES-BES, puerto 8003).
- El flujo para emitir **facturas** es completamente funcional y asíncrono. La venta en el POS se registra de inmediato y la factura electrónica se procesa en segundo plano sin bloquear la interfaz de usuario.
- El PDF de la factura (RIDE) fue rediseñado exitosamente para coincidir con el formato solicitado por el usuario, incluyendo el logo de la empresa obtenido desde la base de datos.
- La interfaz de usuario ha sido mejorada significativamente:
    - Se creó un menú desplegable Facturación Electrónica con submenús para Facturas Electrónicas y Notas de Crédito.
    - Se creó una nueva página para listar, ver y gestionar las Notas de Crédito.
    - El listado de documentos ahora se ordena por número descendente y muestra hasta 50 documentos, solucionando el problema de visualización.
    - Se agregaron indicadores visuales en la lista de facturas para señalar cuáles ya tienen una nota de crédito asociada.
- El problema de las ventas que no aparecían en los reportes fue investigado y se concluyó que era un malentendido; las ventas **sí aparecen correctamente**.
- La lógica base para las notas de crédito (índice de la base de datos, flujo de creación) se ha corregido, pero sigue fallando en el paso final de autorización.

**Last working item**:
- **Last item agent was working**: Depurando el error FIRMA INVALIDA que ocurre exclusivamente al procesar Notas de Crédito.
- **Status**: IN PROGRESS
- **Agent Testing Done**: N
- **Which testing method agent to use?**: backend testing agent. El agente debe modificar el generador de XML, limpiar la base de datos de los intentos fallidos y volver a probar la creación de una nota de crédito.
- **User Testing Done**: N

**All Pending/In progress Issue list**:
- **Issue 1: Las Notas de Crédito fallan con el error FIRMA INVALIDA (P0)**
    - **Attempted fixes**:
        - Se corrigió el índice único en la colección  para permitir que facturas y notas de crédito compartan el mismo secuencial numérico.
        - Se corrigió el orden de los elementos dentro del XML de la nota de crédito para cumplir con el esquema XSD del SRI.
        - Se identificó la causa raíz más probable: el XML de las notas de crédito se genera con , lo que añade saltos de línea, a diferencia del XML de las facturas (que funciona) que se genera en una sola línea. Esta diferencia de formato invalida la firma digital cuando el  la procesa.
    - **Next debug checklist**:
        1.  Abrir el archivo .
        2.  Localizar la llamada a  para las notas de crédito (alrededor de la línea 317 en el historial).
        3.  Cambiar el parámetro  a .
        4.  Ejecutar un script para limpiar la base de datos: eliminar todas las notas de crédito existentes (fallidas) y resetear el flag  en las facturas asociadas.
        5.  Probar a crear una nueva nota de crédito desde la interfaz de usuario para una factura autorizada.
        6.  Verificar en los logs y en la UI si la nueva nota de crédito obtiene el estado AUTORIZADO.
    - **Why fix this issue and what will be achieved with the fix?**: Completar el ciclo de vida de la facturación electrónica, permitiendo a los usuarios anular facturas de forma legal, lo cual es un requisito fundamental del negocio.
    - **Status**: IN PROGRESS
    - **Is recurring issue?**: Y
    - **Should Test frontend/backend/both after fix?**: backend
    - **Blocked on other issue**: No

**In progress Task List**:
- Ninguna. Toda la atención está en el Issue 1.

**Upcoming and Future Tasks**
- **Upcoming Tasks:**
    - **P1: Añadir el número de autorización del SRI al ticket impreso del POS.** Aunque se modificó el frontend para esperar la clave de acceso, es necesario verificar si el número de autorización (que llega después de la sincronización) también se imprime en el ticket final.
- **Future Tasks:**
    - **P1:** Implementar funcionalidades pendientes del POS: Reloj checador, Impresoras de cocina, Pantalla para clientes.
    - **P2:** Convertir la aplicación a PWA (Progressive Web App).
    - **P3:** Añadir búsqueda por rango de montos en el reporte de Recibos.
    - **P4:** Añadir la opción de enviar recibo por email.

**Completed work in this session**
- **SOLVED - PDF RIDE Rediseñado:** Se reescribió el generador de PDF () para que coincida con el formato visual solicitado por el usuario, incluyendo el logo de la empresa y un código de barras correctamente dimensionado.
- **SOLVED - Facturación Asíncrona:** Se modificó el flujo de facturación en el POS para que sea asíncrono usando  de FastAPI, eliminando la lentitud en la interfaz de usuario.
- **SOLVED - Visualización de Documentos Electrónicos:** Se corrigió la lista de documentos para que ordene por número de factura descendente y muestre 50 documentos por página, solucionando la queja del usuario de no ver todas sus facturas.
- **SOLVED - Problema de Reportes:** Se investigó y confirmó que las ventas con facturación electrónica SÍ aparecen correctamente en los reportes de Recibos.
- **FEATURE - Nueva Estructura de Menú para FE:** Se creó un menú desplegable Facturación Electrónica en el sidebar con enlaces a Facturas Electrónicas y una nueva página de Notas de Crédito.
- **FEATURE - Página y Flujo de Notas de Crédito:** Se creó la página , se implementaron indicadores visuales para facturas con NC y un botón de reintento para NC fallidas.
- **BUGFIX - Índice de Base de Datos para NC:** Se corrigió un error de  al crear notas de crédito modificando el índice único de la colección para incluir el .
- **BUGFIX - Instalación de Java:** Se solucionó el error  que detenía el  instalando .

**Earlier issues found/mentioned but not fixed**
- **Issue 1:** El directorio  debería ser renombrado a  para mejorar la claridad de la arquitectura. Esta tarea de refactorización sigue pendiente.

**Known issue recurrence from previous fork**
- Ninguno.

**Code Architecture**


**Key Technical Concepts**
- **Asynchronous Tasks ():** Utilizado para desacoplar el proceso de facturación electrónica de la respuesta inmediata al usuario en el POS.
- **Firma Digital XAdES-BES:** El problema central restante (FIRMA INVALIDA) está relacionado con la canonicalización del XML antes de la firma, específicamente por la diferencia de formato (saltos de línea) entre el XML de facturas y el de notas de crédito.
- **MongoDB Indexing:** Se solucionó un  modificando un índice compuesto único () para incluir el tipo de documento ().
- **PDF Generation ():** Se utilizó para una reescritura completa del diseño del PDF RIDE.

**key DB schema**
- ****: El índice único se cambió a . Se añadió el campo booleano  a los documentos de factura.

**All files of reference**
-  (Archivo clave para solucionar el P0 issue).
-  (Lógica de negocio para FE).
-  (Nueva página de Notas de Crédito).
-  (UI de la lista de facturas).
-  (Navegación del sidebar).
-  (Backend del POS con la tarea asíncrona).

**Areas that need refactoring**:
- Renombrar el directorio  a  para una mayor claridad arquitectónica.

**key api endpoints**
- : Endpoint para crear notas de crédito. **Actualmente falla por firma inválida.**
- : **NUEVO** endpoint asíncrono en el backend del POS que procesa la factura electrónica en segundo plano. **Funciona correctamente.**
- : Endpoint para listar documentos. **Modificado para ordenar por número y aumentar el límite.**
- : Endpoint para generar el PDF. **Funciona correctamente con el nuevo diseño.**

**Critical Info for New Agent**
- La prioridad absoluta (P0) es solucionar el error FIRMA INVALIDA de las Notas de Crédito. La causa raíz es el parámetro  en . Debes cambiarlo a .
- Después de aplicar el cambio en el código, es **crucial** eliminar todas las notas de crédito fallidas de la base de datos ( y ) y resetear el flag  en las facturas referenciadas antes de volver a probar.
- El  (Java) es esencial. Puede entrar en estado . Si ocurre, el comando Hit:1 http://deb.debian.org/debian bookworm InRelease
Get:2 http://deb.debian.org/debian bookworm-updates InRelease [55.4 kB]
Get:3 http://deb.debian.org/debian-security bookworm-security InRelease [48.0 kB]
Get:4 https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0 InRelease [3005 B]
Get:5 https://deb.nodesource.com/node_20.x nodistro InRelease [12.1 kB]
Get:6 http://deb.debian.org/debian-security bookworm-security/main amd64 Packages [292 kB]
Get:7 https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0/multiverse amd64 Packages [100 kB]
Get:8 https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/7.0/multiverse arm64 Packages [98.9 kB]
Fetched 610 kB in 4s (154 kB/s)
Reading package lists...
Reading package lists...
Building dependency tree...
Reading state information...
The following additional packages will be installed:
  ca-certificates-java java-common liblcms2-2 libpcsclite1
Suggested packages:
  default-jre liblcms2-utils pcscd libnss-mdns fonts-dejavu-extra
  fonts-ipafont-mincho fonts-indic
The following NEW packages will be installed:
  ca-certificates-java java-common liblcms2-2 libpcsclite1
  openjdk-17-jre-headless
0 upgraded, 5 newly installed, 0 to remove and 0 not upgraded.
Need to get 44.1 MB of archives.
After this operation, 193 MB of additional disk space will be used.
Get:1 http://deb.debian.org/debian bookworm/main amd64 ca-certificates-java all 20230710~deb12u1 [11.9 kB]
Get:2 http://deb.debian.org/debian bookworm/main amd64 java-common all 0.74 [6388 B]
Get:3 http://deb.debian.org/debian bookworm/main amd64 liblcms2-2 amd64 2.14-2 [154 kB]
Get:4 http://deb.debian.org/debian bookworm/main amd64 libpcsclite1 amd64 1.9.9-2 [49.7 kB]
Get:5 http://deb.debian.org/debian-security bookworm-security/main amd64 openjdk-17-jre-headless amd64 17.0.18+8-1~deb12u1 [43.9 MB]
Fetched 44.1 MB in 1s (82.9 MB/s)
Selecting previously unselected package ca-certificates-java.
(Reading database ... (Reading database ... 5%(Reading database ... 10%(Reading database ... 15%(Reading database ... 20%(Reading database ... 25%(Reading database ... 30%(Reading database ... 35%(Reading database ... 40%(Reading database ... 45%(Reading database ... 50%(Reading database ... 55%(Reading database ... 60%(Reading database ... 65%(Reading database ... 70%(Reading database ... 75%(Reading database ... 80%(Reading database ... 85%(Reading database ... 90%(Reading database ... 95%(Reading database ... 100%(Reading database ... 38153 files and directories currently installed.)
Preparing to unpack .../ca-certificates-java_20230710~deb12u1_all.deb ...
Unpacking ca-certificates-java (20230710~deb12u1) ...
Selecting previously unselected package java-common.
Preparing to unpack .../java-common_0.74_all.deb ...
Unpacking java-common (0.74) ...
Selecting previously unselected package liblcms2-2:amd64.
Preparing to unpack .../liblcms2-2_2.14-2_amd64.deb ...
Unpacking liblcms2-2:amd64 (2.14-2) ...
Selecting previously unselected package libpcsclite1:amd64.
Preparing to unpack .../libpcsclite1_1.9.9-2_amd64.deb ...
Unpacking libpcsclite1:amd64 (1.9.9-2) ...
Selecting previously unselected package openjdk-17-jre-headless:amd64.
Preparing to unpack .../openjdk-17-jre-headless_17.0.18+8-1~deb12u1_amd64.deb ...
Unpacking openjdk-17-jre-headless:amd64 (17.0.18+8-1~deb12u1) ...
Setting up liblcms2-2:amd64 (2.14-2) ...
Setting up java-common (0.74) ...
Setting up libpcsclite1:amd64 (1.9.9-2) ...
Setting up ca-certificates-java (20230710~deb12u1) ...
No JRE found. Skipping Java certificates setup.
Setting up openjdk-17-jre-headless:amd64 (17.0.18+8-1~deb12u1) ...
update-alternatives: using /usr/lib/jvm/java-17-openjdk-amd64/bin/java to provide /usr/bin/java (java) in auto mode
update-alternatives: using /usr/lib/jvm/java-17-openjdk-amd64/bin/jpackage to provide /usr/bin/jpackage (jpackage) in auto mode
update-alternatives: using /usr/lib/jvm/java-17-openjdk-amd64/bin/keytool to provide /usr/bin/keytool (keytool) in auto mode
update-alternatives: using /usr/lib/jvm/java-17-openjdk-amd64/bin/rmiregistry to provide /usr/bin/rmiregistry (rmiregistry) in auto mode
update-alternatives: using /usr/lib/jvm/java-17-openjdk-amd64/lib/jexec to provide /usr/bin/jexec (jexec) in auto mode
Processing triggers for libc-bin (2.36-9+deb12u13) ...
Processing triggers for ca-certificates-java (20230710~deb12u1) ...
Adding debian:ACCVRAIZ1.pem
Adding debian:AC_RAIZ_FNMT-RCM.pem
Adding debian:AC_RAIZ_FNMT-RCM_SERVIDORES_SEGUROS.pem
Adding debian:ANF_Secure_Server_Root_CA.pem
Adding debian:Actalis_Authentication_Root_CA.pem
Adding debian:AffirmTrust_Commercial.pem
Adding debian:AffirmTrust_Networking.pem
Adding debian:AffirmTrust_Premium.pem
Adding debian:AffirmTrust_Premium_ECC.pem
Adding debian:Amazon_Root_CA_1.pem
Adding debian:Amazon_Root_CA_2.pem
Adding debian:Amazon_Root_CA_3.pem
Adding debian:Amazon_Root_CA_4.pem
Adding debian:Atos_TrustedRoot_2011.pem
Adding debian:Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068.pem
Adding debian:Autoridad_de_Certificacion_Firmaprofesional_CIF_A62634068_2.pem
Adding debian:Baltimore_CyberTrust_Root.pem
Adding debian:Buypass_Class_2_Root_CA.pem
Adding debian:Buypass_Class_3_Root_CA.pem
Adding debian:CA_Disig_Root_R2.pem
Adding debian:CFCA_EV_ROOT.pem
Adding debian:COMODO_Certification_Authority.pem
Adding debian:COMODO_ECC_Certification_Authority.pem
Adding debian:COMODO_RSA_Certification_Authority.pem
Adding debian:Certainly_Root_E1.pem
Adding debian:Certainly_Root_R1.pem
Adding debian:Certigna.pem
Adding debian:Certigna_Root_CA.pem
Adding debian:Certum_EC-384_CA.pem
Adding debian:Certum_Trusted_Network_CA.pem
Adding debian:Certum_Trusted_Network_CA_2.pem
Adding debian:Certum_Trusted_Root_CA.pem
Adding debian:Comodo_AAA_Services_root.pem
Adding debian:D-TRUST_BR_Root_CA_1_2020.pem
Adding debian:D-TRUST_EV_Root_CA_1_2020.pem
Adding debian:D-TRUST_Root_Class_3_CA_2_2009.pem
Adding debian:D-TRUST_Root_Class_3_CA_2_EV_2009.pem
Adding debian:DigiCert_Assured_ID_Root_CA.pem
Adding debian:DigiCert_Assured_ID_Root_G2.pem
Adding debian:DigiCert_Assured_ID_Root_G3.pem
Adding debian:DigiCert_Global_Root_CA.pem
Adding debian:DigiCert_Global_Root_G2.pem
Adding debian:DigiCert_Global_Root_G3.pem
Adding debian:DigiCert_High_Assurance_EV_Root_CA.pem
Adding debian:DigiCert_TLS_ECC_P384_Root_G5.pem
Adding debian:DigiCert_TLS_RSA4096_Root_G5.pem
Adding debian:DigiCert_Trusted_Root_G4.pem
Adding debian:E-Tugra_Certification_Authority.pem
Adding debian:E-Tugra_Global_Root_CA_ECC_v3.pem
Adding debian:E-Tugra_Global_Root_CA_RSA_v3.pem
Adding debian:Entrust.net_Premium_2048_Secure_Server_CA.pem
Adding debian:Entrust_Root_Certification_Authority.pem
Adding debian:Entrust_Root_Certification_Authority_-_EC1.pem
Adding debian:Entrust_Root_Certification_Authority_-_G2.pem
Adding debian:Entrust_Root_Certification_Authority_-_G4.pem
Adding debian:GDCA_TrustAUTH_R5_ROOT.pem
Adding debian:GLOBALTRUST_2020.pem
Adding debian:GTS_Root_R1.pem
Adding debian:GTS_Root_R2.pem
Adding debian:GTS_Root_R3.pem
Adding debian:GTS_Root_R4.pem
Adding debian:GlobalSign_ECC_Root_CA_-_R4.pem
Adding debian:GlobalSign_ECC_Root_CA_-_R5.pem
Adding debian:GlobalSign_Root_CA.pem
Adding debian:GlobalSign_Root_CA_-_R3.pem
Adding debian:GlobalSign_Root_CA_-_R6.pem
Adding debian:GlobalSign_Root_E46.pem
Adding debian:GlobalSign_Root_R46.pem
Adding debian:Go_Daddy_Class_2_CA.pem
Adding debian:Go_Daddy_Root_Certificate_Authority_-_G2.pem
Adding debian:HARICA_TLS_ECC_Root_CA_2021.pem
Adding debian:HARICA_TLS_RSA_Root_CA_2021.pem
Adding debian:Hellenic_Academic_and_Research_Institutions_ECC_RootCA_2015.pem
Adding debian:Hellenic_Academic_and_Research_Institutions_RootCA_2015.pem
Adding debian:HiPKI_Root_CA_-_G1.pem
Adding debian:Hongkong_Post_Root_CA_1.pem
Adding debian:Hongkong_Post_Root_CA_3.pem
Adding debian:ISRG_Root_X1.pem
Adding debian:ISRG_Root_X2.pem
Adding debian:IdenTrust_Commercial_Root_CA_1.pem
Adding debian:IdenTrust_Public_Sector_Root_CA_1.pem
Adding debian:Izenpe.com.pem
Adding debian:Microsec_e-Szigno_Root_CA_2009.pem
Adding debian:Microsoft_ECC_Root_Certificate_Authority_2017.pem
Adding debian:Microsoft_RSA_Root_Certificate_Authority_2017.pem
Adding debian:NAVER_Global_Root_Certification_Authority.pem
Adding debian:NetLock_Arany_=Class_Gold=_Főtanúsítvány.pem
Adding debian:OISTE_WISeKey_Global_Root_GB_CA.pem
Adding debian:OISTE_WISeKey_Global_Root_GC_CA.pem
Adding debian:QuoVadis_Root_CA_1_G3.pem
Adding debian:QuoVadis_Root_CA_2.pem
Adding debian:QuoVadis_Root_CA_2_G3.pem
Adding debian:QuoVadis_Root_CA_3.pem
Adding debian:QuoVadis_Root_CA_3_G3.pem
Adding debian:SSL.com_EV_Root_Certification_Authority_ECC.pem
Adding debian:SSL.com_EV_Root_Certification_Authority_RSA_R2.pem
Adding debian:SSL.com_Root_Certification_Authority_ECC.pem
Adding debian:SSL.com_Root_Certification_Authority_RSA.pem
Adding debian:SZAFIR_ROOT_CA2.pem
Adding debian:Sectigo_Public_Server_Authentication_Root_E46.pem
Adding debian:Sectigo_Public_Server_Authentication_Root_R46.pem
Adding debian:SecureSign_RootCA11.pem
Adding debian:SecureTrust_CA.pem
Adding debian:Secure_Global_CA.pem
Adding debian:Security_Communication_ECC_RootCA1.pem
Adding debian:Security_Communication_RootCA2.pem
Adding debian:Security_Communication_RootCA3.pem
Adding debian:Security_Communication_Root_CA.pem
Adding debian:Starfield_Class_2_CA.pem
Adding debian:Starfield_Root_Certificate_Authority_-_G2.pem
Adding debian:Starfield_Services_Root_Certificate_Authority_-_G2.pem
Adding debian:SwissSign_Gold_CA_-_G2.pem
Adding debian:SwissSign_Silver_CA_-_G2.pem
Adding debian:T-TeleSec_GlobalRoot_Class_2.pem
Adding debian:T-TeleSec_GlobalRoot_Class_3.pem
Adding debian:TUBITAK_Kamu_SM_SSL_Kok_Sertifikasi_-_Surum_1.pem
Adding debian:TWCA_Global_Root_CA.pem
Adding debian:TWCA_Root_Certification_Authority.pem
Adding debian:TeliaSonera_Root_CA_v1.pem
Adding debian:Telia_Root_CA_v2.pem
Adding debian:TrustCor_ECA-1.pem
Adding debian:TrustCor_RootCert_CA-1.pem
Adding debian:TrustCor_RootCert_CA-2.pem
Adding debian:Trustwave_Global_Certification_Authority.pem
Adding debian:Trustwave_Global_ECC_P256_Certification_Authority.pem
Adding debian:Trustwave_Global_ECC_P384_Certification_Authority.pem
Adding debian:TunTrust_Root_CA.pem
Adding debian:UCA_Extended_Validation_Root.pem
Adding debian:UCA_Global_G2_Root.pem
Adding debian:USERTrust_ECC_Certification_Authority.pem
Adding debian:USERTrust_RSA_Certification_Authority.pem
Adding debian:XRamp_Global_CA_Root.pem
Adding debian:certSIGN_ROOT_CA.pem
Adding debian:certSIGN_Root_CA_G2.pem
Adding debian:e-Szigno_Root_CA_2017.pem
Adding debian:ePKI_Root_Certification_Authority.pem
Adding debian:emSign_ECC_Root_CA_-_C3.pem
Adding debian:emSign_ECC_Root_CA_-_G3.pem
Adding debian:emSign_Root_CA_-_C1.pem
Adding debian:emSign_Root_CA_-_G1.pem
Adding debian:vTrus_ECC_Root_CA.pem
Adding debian:vTrus_Root_CA.pem
done.
signer-service: ERROR (not running)
signer-service: started lo soluciona.
- El error FIRMA INVALIDA es un bug de código, pero otros errores como Connection aborted o RECHAZADO sin más detalles pueden ser problemas de red temporales con el SRI y no necesariamente errores en la aplicación.

**documents and test reports created in this job**
- /app/test_reports/iteration_7.json (Prueba del generador de PDF, ahora parcialmente desactualizado por el rediseño posterior).

**Last 10 User Messages and any pending HUMAN messages**
1.  **DONE:** El usuario informa sobre problemas con las notas de crédito y los reportes. (El problema de reportes se desmintió, el de NC es el P0).
2.  **DONE:** El usuario reporta un error con una imagen, pide un reporte para NC y que se añada la fecha al detalle de la factura. (Se creó el menú, la página de NC y se añadió la fecha).
3.  **DONE:** El usuario pide un mejor flujo para las NC procesadas y un manejo de errores. (Se implementaron indicadores y un botón de reintento).
4.  **DONE:** El usuario pregunta por qué hay NC duplicadas y por qué siguen RECHAZADAS. (Se eliminaron duplicados y se investigó el estado RECHAZADO, encontrando el error de estructura XML).
5.  **IN PROGRESS:** El usuario pide continuar con la P0. (El agente está trabajando en la solución de FIRMA INVALIDA).
6.  *... (Los mensajes restantes son interacciones durante la depuración del agente)*

**Project Health Check:**
- **Broken:** La creación de Notas de Crédito está rota debido al error de FIRMA INVALIDA.
- **Mocked:** Nada está maquetado. Las funcionalidades implementadas están conectadas.

**3rd Party Integrations**
-  (para cliente SOAP hacia el SRI)
-  (para manipulación de XML)
- **Java 17 / SparkJava / xades4j** (para el microservicio de firma digital)

**Testing status**
- Testing agent used after significant changes: YES (para el generador de PDF inicial).
- Troubleshoot agent used after agent stuck in loop: NO.
- Test files created: []
- Known regressions: Ninguno.

**Credentials to test flow:**
- **Usuario:** 
- **Contraseña:** 

**What agent forgot to execute**
- El agente identificó la solución para el error FIRMA INVALIDA () pero no llegó a implementarla. Es el siguiente paso inmediato y lógico.</analysis>
